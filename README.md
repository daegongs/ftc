# FTC 업무 자동화 프로젝트 (FTC Automation Tools)

이 프로젝트는 공정거래위원회(FTC)와 관련된 데이터 수집, 법령 정보 관리, 그리고 내부 업무 배포 과정을 자동화하기 위한 스크립트 모음입니다.

## 📂 주요 기능 및 구성 요소

### 1. 법령 정보 수집 및 관리 (`scraper.py`, `ftc_law_print.py`)
- **`scraper.py`**: 공정거래위원회 홈페이지에서 소관 법령(법률, 시행령, 시행규칙, 고시·지침 등) 목록을 스크래핑하여 엑셀 파일(`ftc_law_data.xlsx`)로 저장합니다.
- **`ftc_law_print.py`**: 수집된 법령 목록의 상세 페이지 URL을 방문하여 내용을 PDF 파일로 변환합니다. 법령 종류별로 폴더를 생성하여 체계적으로 저장합니다.
- **`extract_links.py`**: 엑셀 파일에서 특정 조건에 맞는 링크를 추출하는 보조 도구입니다.

### 2. 데이터 배포 자동화 (`distribute_by_manager.py`)
- **`distribute_by_manager.py`**: 매핑 정보(담당자-법인)를 바탕으로 대규모 기업집단의 임원지분현황 데이터를 담당자별로 분리하여 개별 엑셀 시트로 생성합니다. 원본 파일의 스타일(너비, 폰트, 테두리 등)을 그대로 유지하며 배포용 파일을 생성합니다.

### 3. 보도자료 수집 (`보도자료.py`)
- **`보도자료.py`**: 공정거래위원회 홈페이지의 보도자료 게시판에서 최신 정보를 스크래핑하여 데이터화합니다.

### 4. 기타 유용한 도구
- **`law_scraper.py`**: 법령 상세 정보를 수집하기 위한 대안 스크래퍼입니다.
- **`check_excel.py`**: 엑셀 파일의 구조와 데이터를 검증하기 위한 유틸리티입니다.

## 🛠 기술 스택
- **언어**: Python 3.x
- **주요 라이브러리**:
  - `requests`, `BeautifulSoup4`: 웹 스크래핑 및 크롤링
  - `pandas`, `openpyxl`: 엑셀 데이터 처리 및 분석
  - `playwright`: 웹 페이지 PDF 변환
  - `pathlib`: 경로 및 파일 시스템 관리

## 🚀 시작하기

### 1. 환경 설정
필요한 패키지를 설치합니다:
```bash
pip install -r requirements.txt
playwright install chromium
```

### 2. 사용 방법

#### 법령 목록 수집
```bash
python scraper.py
```

#### 법령 PDF 생성
```bash
python ftc_law_print.py
```

#### 담당자별 파일 배포
```bash
python distribute_by_manager.py
```

## 📊 결과물 구조
- `output/`: 생성된 PDF 파일 및 배포용 엑셀 파일이 저장되는 디렉토리
- `smer/`: 입력 데이터(담당자 정보, 원본 지분 현황 등)가 위치하는 디렉토리
- `*.xlsx`: 수집된 원본 데이터 파일

## 📝 참고 사항
- 공정거래위원회 홈페이지 구조 변경 시 스크래퍼의 CSS 선택자 업데이트가 필요할 수 있습니다.
- 대량의 페이지를 크롤링할 때는 서버 부하를 방지하기 위해 `time.sleep()`을 적절히 사용합니다.
